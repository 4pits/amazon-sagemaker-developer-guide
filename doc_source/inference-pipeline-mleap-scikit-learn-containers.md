# Feature Processing with SparkML and Scikit\-learn<a name="inference-pipeline-mleap-scikit-learn-containers"></a>

You typically have to explore, preprocess, and featurize your data before using it to train a model\. \(For information on how to do this in Amazon SageMaker, see [Explore and Preprocess Data](how-it-works-notebooks-instances.md)\)\. You can use Spark and scikit\-learn preprocessors to transform your data and engineer features before you train your models with Amazon SageMaker built\-in algorithms or with your own custom algorithms\. You can execute your SparkML jobs with [AWS Glue](https://docs.aws.amazon.com/glue/latest/dg/what-is-glue.html), a serverless ETL service from your Amazon SageMaker notebook\. You can also connect to existing EMR clusters to run their SparkML jobs using [Amazon EMR](https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-what-is-emr.html)\. This requires that you create an IAM role that grants permission for making calls from your Amazon SageMaker notebook to AWS Glue\. AWS Glue currently only supports Python 2\.7\. 

These jobs are then packaged and serialized with MLeap into MLeap containers that can be added to an inference pipeline\. This removes the need for externally managed Spark clusters and allows you to seamlessly scale from a sample of rows to terabytes of data\. The same transformers work at both training and inference time, so you no longer need to duplicate preprocessing and feature engineering logic or come up with your own one\-time solution to persist these models\. The end\-to\-end solutions that Amazon SageMaker Inference Pipelines provides eliminates the need to maintain outside infrastructure and enables making predictions directly from data inputs\.

As part of the SparkML jobs run on AWS Glue, a SparkML pipeline is serialized into [MLeap](http://mleap-docs.combust.ml/) format\. It can then be used with the [SparkML Model Serving Container](https://github.com/aws/sagemaker-sparkml-serving-container) with Amazon SageMaker Inference Pipelines\. *MLeap* is a serialization format and execution engine for machine learning pipelines\. It supports Spark, Scikit\-learn and TensorFlow for training pipelines and exporting them to a serialized pipeline called an MLeap Bundle\. Bundles can be deserialized back into Spark for batch\-mode scoring or the MLeap runtime to power real\-time API services\.

Scikit\-learn jobs can be executed and packaged into containers directly on Amazon SageMaker\. For a similar example of Python code for building a scikit\-learn featurizer model that trains on [Fisher's Iris flower data set](http://archive.ics.uci.edu/ml/datasets/Iris) and predicts the species of Iris based on morphological measurements, see [IRIS Training and Prediction with Sagemaker Scikit\-learn](https://github.com/awslabs/amazon-sagemaker-examples/tree/master/sagemaker-python-sdk/scikit_learn_iris)\. 